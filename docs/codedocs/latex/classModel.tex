\hypertarget{classModel}{
\section{Model Class Reference}
\label{classModel}\index{Model@{Model}}
}
{\tt \#include $<$model.h$>$}

Collaboration diagram for Model:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=245pt]{classModel__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\hyperlink{classModel_e3b375de5f6df4faf74a95d64748e048}{Model} ()
\begin{CompactList}\small\item\em Default constructor. \item\end{CompactList}\item 
\hyperlink{classModel_0dfa7627123dd65d7593b72cf03901f9}{Model} (int queueSize)
\begin{CompactList}\small\item\em Optional constructor. \item\end{CompactList}\item 
virtual \hyperlink{classModel_d6ebd2062a0b823db841a0b88baac4c0}{$\sim$Model} ()
\item 
virtual bool \hyperlink{classModel_1273906325b572fe38cc3c74c8f0f831}{EnqueueAction} (\hyperlink{classAction}{Action} $\ast$action)
\item 
virtual \hyperlink{classAction}{Action} $\ast$ \hyperlink{classModel_49c672e91b844a13b8cbee1d2382a5b4}{DequeueAction} ()
\item 
virtual \hyperlink{classState}{State} $\ast$ \hyperlink{classModel_a92abd0332df9f768033423b0cd8b3ae}{DequeueState} ()
\item 
virtual \hyperlink{classState}{State} $\ast$ \hyperlink{classModel_aca96bcd2e019aad9c4d4d7203b77cce}{GetState} ()
\item 
virtual bool \hyperlink{classModel_8b2d324213cf67b2e139144a25c6e3c3}{SetState} (\hyperlink{classState}{State} $\ast$newState)
\item 
virtual void \hyperlink{classModel_dca495055a5153c982891398d016e22d}{SetListener} (\hyperlink{classModelListener}{ModelListener} $\ast$l)
\item 
virtual void \hyperlink{classModel_d45dc4b460f571d748905f1c19e88577}{SetStunServer} (const PString \&val)
\begin{CompactList}\small\item\em Sets the stun server address or hostname. \item\end{CompactList}\item 
virtual PString \hyperlink{classModel_8011462d91a258e49920db3b157c7af6}{GetStunServer} ()
\begin{CompactList}\small\item\em Returns the stun server address or hostname. \item\end{CompactList}\item 
virtual void \hyperlink{classModel_d2fd66a01c2cea8bc295567da8998733}{SetStunType} (const PString \&val)
\begin{CompactList}\small\item\em Sets the stun server type description. \item\end{CompactList}\item 
virtual PString \hyperlink{classModel_6c040c5501c12f31f260280ea872b0b4}{GetStunType} ()
\begin{CompactList}\small\item\em Returns the stun server type description. \item\end{CompactList}\item 
virtual void \hyperlink{classModel_437d34289432b9687d0bc2f65d89aa4f}{SetRegistrar} (const PString \&val)
\begin{CompactList}\small\item\em Sets the SIP server address or hostname. \item\end{CompactList}\item 
virtual PString \hyperlink{classModel_5d7dd928f54ce00e04f1763728b9b85a}{GetRegistrar} ()
\begin{CompactList}\small\item\em Returns the stun server type description. \item\end{CompactList}\item 
virtual void \hyperlink{classModel_de7353a1170fbb7f587c069270be7f7a}{SetUserName} (const PString \&val)
\begin{CompactList}\small\item\em Sets the user name. \item\end{CompactList}\item 
virtual PString \hyperlink{classModel_18c1848740876abd9544c870c6665879}{GetUserName} ()
\begin{CompactList}\small\item\em Returns the user name. \item\end{CompactList}\item 
virtual void \hyperlink{classModel_e9a19897ea5d7d2417085a5d3a2a2f72}{SetDestination} (const PString \&val)
\begin{CompactList}\small\item\em Sets the call destination. \item\end{CompactList}\item 
virtual PString \hyperlink{classModel_b4354c982ea5543a43f9dfc0874ece20}{GetDestination} ()
\begin{CompactList}\small\item\em Returns the most recent call destination. \item\end{CompactList}\item 
virtual \hyperlink{classAccountList}{AccountList} $\ast$ \hyperlink{classModel_a0be0a124810faa919249d9a51bde1f4}{GetAccountList} (const PString \&fname)
\begin{CompactList}\small\item\em Returns a pointer to an \hyperlink{classAccountList}{AccountList} object attached to the given file. \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
The \hyperlink{classTeleKarma}{TeleKarma} NG \hyperlink{classModel}{Model} superclass. 

The \hyperlink{classModel}{Model} holds system state and related data. Notably, the model stores the current state of the system, a queue of action requests generated by the \hyperlink{classView}{View} and a queue of error messages generated by the \hyperlink{classController}{Controller}. 

The \hyperlink{classModel}{Model} is designed to be robust and easy to use in multithreaded environments. All mutable internal fields are protected by private mutexes to prevent reading of those fields in an inconsistent state. 

{\bf Memory Management} 

It is critically important for developers utilizing methods of this class to read and understand the documentation for each method used. Method documentation discusses the caller's memory management responsibilities. These responsibilities vary depending on which method is being used. 

{\bf Thread Safety} 

This class is thread-safe when used properly. Extend this class with great care to preserve its thread-safe attributes. This class is designed to share information between threads. This mission motivates a concurrency-aware design that makes a best effort to prevent concurrency errors. However, this class does not prevent all possible concurrency errors that are potentially associated with its use. Developers must read and understand the documentation associated with each method. 

{\bf Dependencies} 

All \hyperlink{classState}{State} classes must correctly implement a clone method that returns a pointer to a new and complete copy of the object. This method must never return a pointer to a copy of the object shared with another caller and must not retain a copy of the pointer returned.  

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classModel_e3b375de5f6df4faf74a95d64748e048}{
\index{Model@{Model}!Model@{Model}}
\index{Model@{Model}!Model@{Model}}
\subsubsection[{Model}]{\setlength{\rightskip}{0pt plus 5cm}Model::Model ()}}
\label{classModel_e3b375de5f6df4faf74a95d64748e048}


Default constructor. 

Creates a model with action and error message queues of fixed size equal to \hyperlink{model_8h_142810068f1b99cd93d3fc9f0e160e02}{QUEUE\_\-SIZE}. \hypertarget{classModel_0dfa7627123dd65d7593b72cf03901f9}{
\index{Model@{Model}!Model@{Model}}
\index{Model@{Model}!Model@{Model}}
\subsubsection[{Model}]{\setlength{\rightskip}{0pt plus 5cm}Model::Model (int {\em queueSize})}}
\label{classModel_0dfa7627123dd65d7593b72cf03901f9}


Optional constructor. 

Creates a model with action and error message queues of fixed size specified by the caller using the queueSize parameter. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em queueSize}]how big to make the queues. \end{description}
\end{Desc}
\hypertarget{classModel_d6ebd2062a0b823db841a0b88baac4c0}{
\index{Model@{Model}!$\sim$Model@{$\sim$Model}}
\index{$\sim$Model@{$\sim$Model}!Model@{Model}}
\subsubsection[{$\sim$Model}]{\setlength{\rightskip}{0pt plus 5cm}Model::$\sim$Model ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_d6ebd2062a0b823db841a0b88baac4c0}


Virtual destructor. Deallocates: \begin{enumerate}
\item All internally allocated memory. \item The memory allocated to the current state. \item The memory allocated to any \hyperlink{classAction}{Action} objects remaining in the action queue. \item The memory allocated to any error messages remaining in the error message queue. \end{enumerate}


\subsection{Member Function Documentation}
\hypertarget{classModel_49c672e91b844a13b8cbee1d2382a5b4}{
\index{Model@{Model}!DequeueAction@{DequeueAction}}
\index{DequeueAction@{DequeueAction}!Model@{Model}}
\subsubsection[{DequeueAction}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Action} $\ast$ Model::DequeueAction ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_49c672e91b844a13b8cbee1d2382a5b4}


Dequeues and returns a pointer to an \hyperlink{classAction}{Action}. 

{\bf Memory Management} 

The caller assumes responsibility for deallocating the memory addressed by the pointer returned by this method. That memory should be deallocated using delete. The caller may deallocate the memory at a time of the caller's choosing. 

{\bf Thread Safety} 

This method is intended for use by a single consumer thread (the \hyperlink{classController}{Controller}). It may be used by multiple consumer threads without endangering built-in thread safety features. An enqueued pointer is never returned more than once, so multiple consumers cannot gain access to the same object solely by using this method. Callers must deallocate, and are free to modify, the memory addressed by the pointer returned by this method. Failure to adhere to these guidelines may defeat the thread safety features of this class. 

Override this method at your own risk!!  \begin{Desc}
\item[Returns:]a pointer to a previously enqueued \hyperlink{classAction}{Action} or NULL if the queue is empty. \end{Desc}
\hypertarget{classModel_a92abd0332df9f768033423b0cd8b3ae}{
\index{Model@{Model}!DequeueState@{DequeueState}}
\index{DequeueState@{DequeueState}!Model@{Model}}
\subsubsection[{DequeueState}]{\setlength{\rightskip}{0pt plus 5cm}{\bf State} $\ast$ Model::DequeueState ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_a92abd0332df9f768033423b0cd8b3ae}


Dequeues and returns a pointer to a state. States are dequeued in the order they were set. 

{\bf Memory Management} 

The caller assumes responsibility for deallocating the memory addressed by the pointer returned by this method. That memory should be deallocated using delete. The caller may deallocate the memory at a time of the caller's choosing. 

{\bf Thread Safety} 

This method is intended for use by a single consumer thread (the \hyperlink{classView}{View}). It may be used by multiple consumer threads without endangering built-in thread safety features. An enqueued pointer is never returned more than once, so multiple consumers cannot gain access to the same object solely by using this method. Callers must deallocate, and are free to modify, the memory addressed by the pointer returned by this method. Failure to adhere to these guidelines may defeat the thread safety features of this class. 

Override this method at your own risk!!  \begin{Desc}
\item[Returns:]a pointer to a previously enqueued state or NULL if the queue is empty. \end{Desc}
\hypertarget{classModel_1273906325b572fe38cc3c74c8f0f831}{
\index{Model@{Model}!EnqueueAction@{EnqueueAction}}
\index{EnqueueAction@{EnqueueAction}!Model@{Model}}
\subsubsection[{EnqueueAction}]{\setlength{\rightskip}{0pt plus 5cm}bool Model::EnqueueAction ({\bf Action} $\ast$ {\em action})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_1273906325b572fe38cc3c74c8f0f831}


Enqueues an action. 

{\bf Memory Management} 

This class assumes responsibility for deallocating the memory addressed by the action parameter if and only if this method returns true. The caller retains responsibility for deallocating the memory addressed by the action parameter if this method returns false, and is free to do so at a time of the caller's choosing. 

{\bf Thread Safety} 

This method is intended for use by a single producer thread (the \hyperlink{classView}{View}). It may be used by multiple producer threads without endangering its thread safety features. Callers {\bf must not modify or deallocate} the memory allocated to the pointer passed into this method after calling this method. The pointer passed into this method must be a pointer to memory on the heap. Failure to adhere to these guidelines may defeat the thread safety features of this class. 

This class stores the pointer passed to this method and may share that pointer with a consumer. This method does not make a copy the memory addressed by the pointer. 

Override this method at your own risk!!  \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em action}]pointer to an \hyperlink{classAction}{Action} object on the heap. \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]false if the pointer cannot be enqueued because the queue is full; true otherwise. \end{Desc}
\hypertarget{classModel_a0be0a124810faa919249d9a51bde1f4}{
\index{Model@{Model}!GetAccountList@{GetAccountList}}
\index{GetAccountList@{GetAccountList}!Model@{Model}}
\subsubsection[{GetAccountList}]{\setlength{\rightskip}{0pt plus 5cm}{\bf AccountList} $\ast$ Model::GetAccountList (const PString \& {\em fname})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_a0be0a124810faa919249d9a51bde1f4}


Returns a pointer to an \hyperlink{classAccountList}{AccountList} object attached to the given file. 

Note that no concurrency support is provided - this method assumes one caller and one call. Caller is responsible for deleting the returned object. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em fname}]path to and name of file containing accounts. \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]an \hyperlink{classAccountList}{AccountList} with at least one \hyperlink{classAccount}{Account}. If the file does not exist or cannot be opened, the \hyperlink{classAccountList}{AccountList} will contain a single \hyperlink{classAccount}{Account} where all values are the empty string. \end{Desc}
\hypertarget{classModel_b4354c982ea5543a43f9dfc0874ece20}{
\index{Model@{Model}!GetDestination@{GetDestination}}
\index{GetDestination@{GetDestination}!Model@{Model}}
\subsubsection[{GetDestination}]{\setlength{\rightskip}{0pt plus 5cm}PString Model::GetDestination ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_b4354c982ea5543a43f9dfc0874ece20}


Returns the most recent call destination. 

Makes a unique copy for the exclusive use of the caller. Caller is responsible for deleting the copy produced. \hypertarget{classModel_5d7dd928f54ce00e04f1763728b9b85a}{
\index{Model@{Model}!GetRegistrar@{GetRegistrar}}
\index{GetRegistrar@{GetRegistrar}!Model@{Model}}
\subsubsection[{GetRegistrar}]{\setlength{\rightskip}{0pt plus 5cm}PString Model::GetRegistrar ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_5d7dd928f54ce00e04f1763728b9b85a}


Returns the stun server type description. 

Makes a unique copy for the exclusive use of the caller. Caller is responsible for deleting the copy produced. \hypertarget{classModel_aca96bcd2e019aad9c4d4d7203b77cce}{
\index{Model@{Model}!GetState@{GetState}}
\index{GetState@{GetState}!Model@{Model}}
\subsubsection[{GetState}]{\setlength{\rightskip}{0pt plus 5cm}{\bf State} $\ast$ Model::GetState ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_aca96bcd2e019aad9c4d4d7203b77cce}


Returns a copy of the current \hyperlink{classState}{State} object. 

{\bf Memory Management} 

The caller assumes responsibility for deallocating the memory addressed by the pointer returned by this method. That memory should be deallocated using delete. The caller may deallocate the memory at a time of the caller's choosing. 

{\bf Thread Safety} 

This method makes a copy of the current \hyperlink{classState}{State} on the heap using that State's clone() method and returns a pointer to the copy. Provided that the \hyperlink{classState}{State} is implemented properly (see class overview documentation), it is not possible for two calls to this method to obtain a pointer to the same copy of a \hyperlink{classState}{State}. This assures thread safety outside of this method and relieves the caller of any responsibility for synchronizing access to the returned memory block.  \begin{Desc}
\item[Returns:]a pointer to a unique copy of the current \hyperlink{classState}{State} object or NULL if the current \hyperlink{classState}{State} is undefined. \end{Desc}
\hypertarget{classModel_8011462d91a258e49920db3b157c7af6}{
\index{Model@{Model}!GetStunServer@{GetStunServer}}
\index{GetStunServer@{GetStunServer}!Model@{Model}}
\subsubsection[{GetStunServer}]{\setlength{\rightskip}{0pt plus 5cm}PString Model::GetStunServer ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_8011462d91a258e49920db3b157c7af6}


Returns the stun server address or hostname. 

Makes a unique copy for the exclusive use of the caller. Caller is responsible for deleting the copy produced. \hypertarget{classModel_6c040c5501c12f31f260280ea872b0b4}{
\index{Model@{Model}!GetStunType@{GetStunType}}
\index{GetStunType@{GetStunType}!Model@{Model}}
\subsubsection[{GetStunType}]{\setlength{\rightskip}{0pt plus 5cm}PString Model::GetStunType ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_6c040c5501c12f31f260280ea872b0b4}


Returns the stun server type description. 

Makes a unique copy for the exclusive use of the caller. Caller is responsible for deleting the copy produced. \hypertarget{classModel_18c1848740876abd9544c870c6665879}{
\index{Model@{Model}!GetUserName@{GetUserName}}
\index{GetUserName@{GetUserName}!Model@{Model}}
\subsubsection[{GetUserName}]{\setlength{\rightskip}{0pt plus 5cm}PString Model::GetUserName ()\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_18c1848740876abd9544c870c6665879}


Returns the user name. 

Makes a unique copy for the exclusive use of the caller. Caller is responsible for deleting the copy produced. \hypertarget{classModel_e9a19897ea5d7d2417085a5d3a2a2f72}{
\index{Model@{Model}!SetDestination@{SetDestination}}
\index{SetDestination@{SetDestination}!Model@{Model}}
\subsubsection[{SetDestination}]{\setlength{\rightskip}{0pt plus 5cm}void Model::SetDestination (const PString \& {\em val})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_e9a19897ea5d7d2417085a5d3a2a2f72}


Sets the call destination. 

Copies the provided value. No expectation of update upon disconnection, but set upon each dialing. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em val}]call destination. \end{description}
\end{Desc}
\hypertarget{classModel_dca495055a5153c982891398d016e22d}{
\index{Model@{Model}!SetListener@{SetListener}}
\index{SetListener@{SetListener}!Model@{Model}}
\subsubsection[{SetListener}]{\setlength{\rightskip}{0pt plus 5cm}void Model::SetListener ({\bf ModelListener} $\ast$ {\em l})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_dca495055a5153c982891398d016e22d}


Sets the sole listener class. The OnStateChange() method of this class will be called each time the state is updated using \hyperlink{classModel_8b2d324213cf67b2e139144a25c6e3c3}{SetState(State $\ast$)}.  \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em l}]a listener class. \end{description}
\end{Desc}
\hypertarget{classModel_437d34289432b9687d0bc2f65d89aa4f}{
\index{Model@{Model}!SetRegistrar@{SetRegistrar}}
\index{SetRegistrar@{SetRegistrar}!Model@{Model}}
\subsubsection[{SetRegistrar}]{\setlength{\rightskip}{0pt plus 5cm}void Model::SetRegistrar (const PString \& {\em val})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_437d34289432b9687d0bc2f65d89aa4f}


Sets the SIP server address or hostname. 

Copies the provided value. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em val}]SIP server address or hostname. \end{description}
\end{Desc}
\hypertarget{classModel_8b2d324213cf67b2e139144a25c6e3c3}{
\index{Model@{Model}!SetState@{SetState}}
\index{SetState@{SetState}!Model@{Model}}
\subsubsection[{SetState}]{\setlength{\rightskip}{0pt plus 5cm}bool Model::SetState ({\bf State} $\ast$ {\em newState})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_8b2d324213cf67b2e139144a25c6e3c3}


Sets and enqueues the current state. 

{\bf Memory Management} 

This class assumes responsibility for deallocating the memory addressed by the pointer passed to this method. 

{\bf Thread Safety} 

Callers {\bf must not modify or deallocate} the memory allocated to the pointer passed into this method after calling this method. The pointer passed into this method must be a pointer to memory on the heap. Failure to adhere to these guidelines may defeat the thread safety features of this class. 

This class stores the pointer passed to this method and makes that pointer available via \hyperlink{classModel_aca96bcd2e019aad9c4d4d7203b77cce}{GetState()}. This call also invokes the clone() method of \hyperlink{classState}{State} to make a distinct copy of the state for the queue.  \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em newState}]the new state. \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]if the new state was successfully enqueued; false indicates the current state was set but could not be enqueued (the state queue is full). \end{Desc}
\hypertarget{classModel_d45dc4b460f571d748905f1c19e88577}{
\index{Model@{Model}!SetStunServer@{SetStunServer}}
\index{SetStunServer@{SetStunServer}!Model@{Model}}
\subsubsection[{SetStunServer}]{\setlength{\rightskip}{0pt plus 5cm}void Model::SetStunServer (const PString \& {\em val})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_d45dc4b460f571d748905f1c19e88577}


Sets the stun server address or hostname. 

Copies the provided value. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em val}]stun server address or hostname. \end{description}
\end{Desc}
\hypertarget{classModel_d2fd66a01c2cea8bc295567da8998733}{
\index{Model@{Model}!SetStunType@{SetStunType}}
\index{SetStunType@{SetStunType}!Model@{Model}}
\subsubsection[{SetStunType}]{\setlength{\rightskip}{0pt plus 5cm}void Model::SetStunType (const PString \& {\em val})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_d2fd66a01c2cea8bc295567da8998733}


Sets the stun server type description. 

Copies the provided value. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em val}]stun server type description. \end{description}
\end{Desc}
\hypertarget{classModel_de7353a1170fbb7f587c069270be7f7a}{
\index{Model@{Model}!SetUserName@{SetUserName}}
\index{SetUserName@{SetUserName}!Model@{Model}}
\subsubsection[{SetUserName}]{\setlength{\rightskip}{0pt plus 5cm}void Model::SetUserName (const PString \& {\em val})\hspace{0.3cm}{\tt  \mbox{[}virtual\mbox{]}}}}
\label{classModel_de7353a1170fbb7f587c069270be7f7a}


Sets the user name. 

Copies the provided value. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em val}]user name. \end{description}
\end{Desc}


The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
\hyperlink{model_8h}{model.h}\item 
\hyperlink{model_8cpp}{model.cpp}\end{CompactItemize}
